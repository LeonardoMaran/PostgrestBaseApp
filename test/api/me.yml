api: /me
method: GET

tests:
  - name: forbid anonym
    superagent:
      set:
        Authorization:
      query:
    t:
      is:
        status: 401

  - name: allow user
    superagent:
      set:
        Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VyX2lkIjoiMiIsInJvbGUiOiJhcHBfdXNlciJ9.w64PSByReB7hkqnvJlwoi3gX2jdJ_7IuMwb9v21UZIE
      query:
    t:
      is:
        status: 200
        body.0.id: 2
        body.0.role: app_user
        body.0.email: george@app.com
      not:
      deepEqual:
      notDeepEqual:

  - name: allow admin
    superagent:
      set:
        Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VyX2lkIjoxLCJyb2xlIjoiYXBwX2FkbWluIn0.dnsjvP4XXaB0XgWkEhhEubfWmSLvm262H-YFUbG8KoQ
      query:
    t:
      is:
        status: 200
        body.0.id: 1
        body.0.role: app_admin
        body.0.email: james@app.com
